appId: "{APP_ID}"

--- 
- launchApp:
    appId: "{APP_ID}"
    clearState: true
    clearKeychain: true
    stopApp: false
    permissions:
      all: allow

- waitForAnimationToEnd
- tapOn:
    id: "text-input-outlined"  
- inputText: "${number_without_areacode_phone_number}"
- waitForAnimationToEnd
- pressKey : enter
- waitForAnimationToEnd
- tapOn:
    id: "CONTINUE_ONBOARDING"
- assertNoDefectsWithAI

- assertNoDefectsWithAI
- tapOn:
    id: textInput
    index: 0
- runScript:
    file: fetchOtp.js
    env:
      TO_PHONE_NUMBER: "{phone_number}"
      TWILIO_ACCOUNT_SID: "${TWILIO_ACCOUNT_SID}"
      TWILIO_AUTH_TOKEN: "${TWILIO_AUTH_TOKEN}"

- evalScript: ${output.OTP_CODE = output.script.result}

- waitForAnimationToEnd
- inputText: "${output.OTP_CODE}"
- waitForAnimationToEnd

